# OWASP Top 10 漏洞分类与模板库

## 目录概览

本目录包含根据 OWASP Top 10 分类组织的安全漏洞模板，精选高危常见类型，适用于渗透测试与自动化安全检测。

## 模板统计

| 子类目录                | 模板数量 |
|------------------------|---------|
| 03_A03注入              | 70+     |
| 04_A05安全配置错误      | 25+     |
| 05_A06存在漏洞或过时的组件 | 50+     |
| 08_A10服务器端请求伪造  | 5       |

## 详细分类说明

### A03 注入 (Injection)
- **子类别**: 10个
  - 命令注入 (Command Injection)
  - DOM 污染 (DOM Clobbering)
  - GraphQL 注入
  - LDAP 注入
  - LaTeX 注入
  - NoSQL 注入
  - SQL 注入
  - 服务器端包含注入 (SSI)
  - 服务器端模板注入 (SSTI)
  - XPath 注入
  - XSS 注入
  - XXE 注入
- **关键漏洞**: 远程代码执行、数据泄露
- **测试重点**: 输入验证、查询构造、上下文感知测试

### A05 安全配置错误 (Security Misconfiguration)
- **子类别**: 5个
  - CORS 错误配置
  - DNS 重绑定
  - HTTP 参数污染
  - 不安全的管理界面
  - 开放重定向
- **关键漏洞**: 未授权访问、信息泄露
- **测试重点**: 默认配置、错误处理、安全头

### A06 存在漏洞或过时的组件
- **子类别**: 1个
  - CVE 漏洞利用
- **关键漏洞**: 已知漏洞利用
- **测试重点**: 版本识别、漏洞扫描、补丁管理

### A10 服务器端请求伪造 (SSRF)
- **子类别**: 1个
  - SSRF 漏洞利用
- **关键漏洞**: 内部网络探测、服务端请求伪造
- **测试重点**: URL 处理、内部服务访问控制

## OWASP Top 10 漏洞原理详解

### A03 注入 (Injection)
- **原理**: 当应用程序将用户输入的数据作为命令、查询或代码的一部分执行时，如果未对输入进行适当的过滤或编码，攻击者可以注入恶意的数据，改变应用程序的执行流程或访问底层系统。
- **常见漏洞**: 
    - **SQL 注入 (SQL Injection)**: 注入恶意 SQL 代码，以访问、修改或删除数据库中的数据。
    - **命令注入 (OS Command Injection / RCE)**: 注入操作系统命令，在服务器上执行任意指令。
    - **跨站脚本 (XSS)**: 注入恶意脚本到网页中，影响其他用户的浏览器。
    - **服务器端模板注入 (SSTI)**: 注入恶意模板指令，在服务器端执行代码。
    - **LDAP 注入、XPath 注入**等。
- **对应标签**: `sql`, `xss`, `ssti`, `rce`, `injection`, `jndi`

### A05 安全配置错误 (Security Misconfiguration)
- **原理**: 应用程序、框架、Web 服务器、数据库或其他组件的安全设置配置不当，导致存在可利用的漏洞。这包括使用默认凭据、暴露敏感信息、启用了不必要的功能或服务等。
- **常见漏洞**: 
    - **使用默认账户和弱密码**。
    - **未关闭或保护的管理接口/面板**。
    - **暴露敏感文件或目录** (如 `.git` 目录泄露)。
    - **详细的错误信息暴露内部系统信息**。
    - **未正确配置的 HTTP 头**（如 CORS、安全标志等）。
- **对应标签**: `misconfig`, `default-login`, `exposed-panel`, `headers`, `config`, `metadata`, `exposure`

### A06 存在漏洞或过时的组件 (Vulnerable and Outdated Components)
- **原理**: 应用程序使用了已知存在安全漏洞的第三方库、框架或其他组件。攻击者可以利用这些组件中的公开漏洞来攻击应用程序。
- **常见漏洞**: 
    - **使用了包含已知 CVE 的库或框架版本**。
    - **使用了长时间未更新的组件**。
    - **使用了废弃或不受支持的组件**。
    - **Log4j 漏洞** (`log4j` 标签) 就是典型的使用了存在漏洞的第三方组件。
- **对应标签**: `cve`, `vuln`, `outdated`, `version`, `log4j`

### A10 服务器端请求伪造 (Server-Side Request Forgery - SSRF)
- **原理**: Web 应用程序从用户提供的 URL 获取资源，但未能充分验证或过滤用户输入的 URL，导致应用程序向攻击者指定的内部或外部服务器发出请求。攻击者可以利用 SSRF 扫描内部网络、访问内部服务或利用服务器作为跳板攻击其他外部系统。
- **常见漏洞**: 
    - **应用程序从用户输入的 URL 加载图片、文件或页面内容，但未限制目标地址**。
    - **使用不安全的库或 API 调用外部资源**。
- **对应标签**: `ssrf` 