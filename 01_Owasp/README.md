# OWASP Top 10 漏洞分类与模板库

## 目录概览

本目录包含根据 OWASP Top 10 分类组织的安全漏洞模板，共计 8 个大类，38 个子类别。这些模板为安全测试人员提供了丰富的测试用例和漏洞利用方法。

### 分类统计

| OWASP 分类 | 子类别数量 | 模板数量 | 主要标签 |
|------------|-----------|---------|---------|
| A01 访问控制失效 | 2 | 12 | `access-control`, `authorization`, `bypass` |
| A02 加密失败 | 2 | 8 | `ssl`, `tls`, `crypto` |
| A03 注入 | 10 | 45 | `sql`, `xss`, `ssti`, `rce` |
| A05 安全配置错误 | 5 | 18 | `misconfig`, `default-login`, `headers` |
| A06 存在漏洞或过时的组件 | 1 | 5 | `cve`, `vuln`, `outdated` |
| A07 身份验证失败 | 3 | 15 | `auth`, `bruteforce`, `login` |
| A08 软件/数据完整性失效 | 5 | 12 | `deserialization`, `race-condition`, `type-juggling` |
| A10 服务器端请求伪造 | 1 | 5 | `ssrf`, `request-forgery` |

## 详细分类说明

### A01 访问控制失效 (Broken Access Control)
- **子类别**: 2个
  - 目录遍历 (Directory Traversal)
  - 不安全的直接对象引用 (Insecure Direct Object References)
- **关键漏洞**: 水平/垂直权限提升、未授权访问
- **测试重点**: 权限验证绕过、路径遍历、敏感文件访问

### A02 加密失败 (Cryptographic Failures)
- **子类别**: 2个
  - 不安全的随机数生成 (Insecure Randomness)
  - JWT 安全问题 (JSON Web Token)
- **关键漏洞**: 弱加密、敏感信息泄露
- **测试重点**: 弱加密算法、密钥管理、敏感数据保护

### A03 注入 (Injection)
- **子类别**: 10个
  - 命令注入 (Command Injection)
  - DOM 污染 (DOM Clobbering)
  - GraphQL 注入
  - LDAP 注入
  - LaTeX 注入
  - NoSQL 注入
  - SQL 注入
  - 服务器端包含注入 (SSI)
  - 服务器端模板注入 (SSTI)
  - XPath 注入
  - XSS 注入
  - XXE 注入
- **关键漏洞**: 远程代码执行、数据泄露
- **测试重点**: 输入验证、查询构造、上下文感知测试

### A05 安全配置错误 (Security Misconfiguration)
- **子类别**: 5个
  - CORS 错误配置
  - DNS 重绑定
  - HTTP 参数污染
  - 不安全的管理界面
  - 开放重定向
- **关键漏洞**: 未授权访问、信息泄露
- **测试重点**: 默认配置、错误处理、安全头

### A06 存在漏洞或过时的组件
- **子类别**: 1个
  - CVE 漏洞利用
- **关键漏洞**: 已知漏洞利用
- **测试重点**: 版本识别、漏洞扫描、补丁管理

### A07 身份验证失败 (Identification and Authentication Failures)
- **子类别**: 3个
  - 账户接管 (Account Takeover)
  - OAuth 错误配置
  - 认证绕过
- **关键漏洞**: 账户劫持、会话固定
- **测试重点**: 认证流程、会话管理、多因素认证

### A08 软件/数据完整性失效
- **子类别**: 5个
  - 不安全的反序列化
  - 竞态条件
  - 类型杂耍
  - Zip Slip 漏洞
  - 数据完整性失效
- **关键漏洞**: 远程代码执行、权限提升
- **测试重点**: 文件处理、序列化操作、并发控制

### A10 服务器端请求伪造 (SSRF)
- **子类别**: 1个
  - SSRF 漏洞利用
- **关键漏洞**: 内部网络探测、服务端请求伪造
- **测试重点**: URL 处理、内部服务访问控制

## 使用说明

1. 导航到目标漏洞类别的目录
2. 查看 README 文件了解漏洞详情和利用方法
3. 使用提供的测试用例进行安全评估
4. 参考防御措施修复漏洞

## 标签说明

- `rce`: 远程代码执行
- `auth`: 认证相关
- `bypass`: 绕过技术
- `misconfig`: 错误配置
- `cve`: 已知漏洞
- `ssrf`: 服务端请求伪造
- `ssti`: 服务器端模板注入
- `xss`: 跨站脚本

---

## OWASP Top 10 漏洞原理详解

### A01 访问控制失效 (Broken Access Control)

- **原理**: 应用程序未能正确实施访问控制策略。这意味着用户可以绕过授权检查，访问他们不应该访问的功能或数据。攻击者可以利用这些缺陷来获取敏感信息、修改用户权限或执行未授权的功能。
- **常见漏洞**: 
    - **垂直权限绕过**: 普通用户可以访问管理员或更高权限用户的功能。
    - **水平权限绕过**: 用户可以访问同等权限下其他用户的数据或资源。
    - **目录遍历 (Directory Traversal/Path Traversal)**: 攻击者通过构造包含 "../" 或类似字符的路径，访问文件系统中的任意文件或目录。
    - **不安全的直接对象引用 (IDOR)**: 应用程序在访问对象时使用用户提供的不可信数据来标识对象，而没有进行充分的授权检查，导致攻击者可以修改参数访问其他用户的对象。
- **对应标签**: `access-control`, `authorization`, `bypass`, `directory-traversal`, `unauth` (有时也与未授权访问相关)

### A02 加密失败 (Cryptographic Failures)

- **原理**: 应用程序在敏感数据（传输中和存储时）的加密、哈希、签名等方面存在缺陷。这可能导致敏感数据（如密码、信用卡信息、个人身份信息）暴露给攻击者。
- **常见漏洞**: 
    - **未加密敏感数据**: 在传输或存储敏感数据时未使用加密。
    - **使用了弱加密算法或协议**: 例如使用 MD5 进行密码哈希，或使用老旧的 TLS 版本。
    - **密钥管理不当**: 硬编码密钥、密钥泄露、使用了弱密钥。
- **对应标签**: `ssl`, `tls`, `heartbleed`, `crypto`

### A03 注入 (Injection)

- **原理**: 当应用程序将用户输入的数据作为命令、查询或代码的一部分执行时，如果未对输入进行适当的过滤或编码，攻击者可以注入恶意的数据，改变应用程序的执行流程或访问底层系统。
- **常见漏洞**: 
    - **SQL 注入 (SQL Injection)**: 注入恶意 SQL 代码，以访问、修改或删除数据库中的数据。
    - **命令注入 (OS Command Injection / RCE)**: 注入操作系统命令，在服务器上执行任意指令。
    - **跨站脚本 (XSS)**: 注入恶意脚本到网页中，影响其他用户的浏览器。
    - **服务器端模板注入 (SSTI)**: 注入恶意模板指令，在服务器端执行代码。
    - **LDAP 注入、XPath 注入**等。
- **对应标签**: `sql`, `xss`, `ssti`, `rce`, `injection`, `jndi` (JNDI 注入是一种特定的注入类型)

### A05 安全配置错误 (Security Misconfiguration)

- **原理**: 应用程序、框架、Web 服务器、数据库或其他组件的安全设置配置不当，导致存在可利用的漏洞。这包括使用默认凭据、暴露敏感信息、启用了不必要的功能或服务等。
- **常见漏洞**: 
    - **使用默认账户和弱密码**。
    - **未关闭或保护的管理接口/面板**。
    - **暴露敏感文件或目录** (如 `.git` 目录泄露)。
    - **详细的错误信息暴露内部系统信息**。
    - **未正确配置的 HTTP 头**（如 CORS、安全标志等）。
- **对应标签**: `misconfig`, `default-login`, `exposed-panel`, `headers`, `config`, `metadata`, `exposure`

### A06 存在漏洞或过时的组件 (Vulnerable and Outdated Components)

- **原理**: 应用程序使用了已知存在安全漏洞的第三方库、框架或其他组件。攻击者可以利用这些组件中的公开漏洞来攻击应用程序。
- **常见漏洞**: 
    - **使用了包含已知 CVE (Common Vulnerabilities and Exposures) 的库或框架版本**。
    - **使用了长时间未更新的组件**，这些组件可能积累了大量未修复的漏洞。
    - **使用了废弃或不受支持的组件**。
    - **Log4j 漏洞** (`log4j` 标签) 就是典型的使用了存在漏洞的第三方组件。
- **对应标签**: `cve`, `vuln`, `outdated`, `version`, `log4j` (属于 Java 框架/平台和 A06)

### A07 身份验证失败 (Identification and Authentication Failures)

- **原理**: 应用程序在验证用户身份、管理会话等方面存在缺陷。这可能导致攻击者绕过身份验证、接管合法用户的会话或使用弱密码进行暴力破解。
- **常见漏洞**: 
    - **弱密码策略或允许暴力破解**。
    - **会话管理不当**（如会话固定、会话劫持）。
    - **未对身份验证过程中的敏感信息进行保护**。
    - **登录逻辑缺陷**（如允许通过非预期方式登录）。
- **对应标签**: `auth`, `bruteforce`, `login`, `token`

### A08 软件和数据完整性失效 (Software and Data Integrity Failures)

- **原理**: 应用程序在软件更新、关键数据处理、CI/CD 流程等方面未能验证软件或数据的完整性，或者在数据处理时存在不安全的反序列化操作。攻击者可以篡改软件更新包、上传恶意数据或利用反序列化漏洞执行代码。
- **常见漏洞**: 
    - **不安全的更新机制**，允许攻击者上传恶意更新。
    - **CI/CD 管道中的安全漏洞**，允许代码注入或篡改。
    - **不安全或易受攻击的反序列化操作**，允许攻击者发送恶意序列化对象，在服务器端执行任意代码。
    - **缺乏对关键数据的完整性检查**。
- **对应标签**: `git`, `ci`, `supply-chain`, `ssrf` (SSRF 也可能导致数据完整性问题), `deserialization`

### A10 服务器端请求伪造 (Server-Side Request Forgery - SSRF)

- **原理**: Web 应用程序从用户提供的 URL 获取资源，但未能充分验证或过滤用户输入的 URL，导致应用程序向攻击者指定的内部或外部服务器发出请求。攻击者可以利用 SSRF 扫描内部网络、访问内部服务或利用服务器作为跳板攻击其他外部系统。
- **常见漏洞**: 
    - **应用程序从用户输入的 URL 加载图片、文件或页面内容，但未限制目标地址**。
    - **使用不安全的库或 API 调用外部资源**。
- **对应标签**: `ssrf` 