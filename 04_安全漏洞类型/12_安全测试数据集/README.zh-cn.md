# 安全测试数据集

> 本目录包含多个关键安全漏洞的测试用例，适用于安全研究、渗透测试和漏洞验证。

## 目录

- [数据集概述](#数据集概述)
- [漏洞分类](#漏洞分类)
- [使用说明](#使用说明)
- [漏洞列表](#漏洞列表)
- [最佳实践](#最佳实践)
- [参考资源](#参考资源)
- [免责声明](#免责声明)

## 数据集概述

本数据集收集了2014年至2023年间公开的多个高危和严重漏洞的测试用例，涵盖以下类型：

- 远程代码执行 (RCE)
- 认证绕过
- 命令注入
- 文件包含
- 反序列化漏洞
- 其他关键Web漏洞

## 漏洞分类

### 按年份分布

- 2014年: 2个
- 2016年: 2个
- 2017年: 1个
- 2018年: 2个
- 2019年: 3个
- 2020年: 2个
- 2021年: 4个
- 2022年: 1个
- 2023年: 2个

### 按严重程度

- 严重 (Critical): 16个
- 高危 (High): 3个

### 按影响系统

- Web应用框架 (WordPress, vBulletin等)
- 网络设备 (Cisco, Netgear等)
- 内容管理系统 (CMS)
- 邮件系统

## 使用说明

### 环境要求

- [Nuclei](https://github.com/projectdiscovery/nuclei) v2.9.0+
- Go 1.17+
- 测试目标系统授权

### 基本用法

```bash
# 测试单个漏洞
nuclei -t CVE-2021-1472.yaml -u https://target.com

# 批量测试目标
nuclei -l targets.txt -t ./

# 使用模板标签筛选
nuclei -t . -tags cve2021 -u https://target.com
```

### 参数说明

- `-u`: 目标URL
- `-l`: 目标文件列表
- `-t`: 模板文件或目录
- `-tags`: 按标签筛选模板
- `-severity`: 按严重程度筛选

## 漏洞列表

| CVE ID | 漏洞名称 | 严重程度 | 影响版本 | 漏洞类型 |
|--------|---------|---------|---------|---------|
| [CVE-2023-50917](CVE-2023-50917.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2023-49070](CVE-2023-49070.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2022-24627](CVE-2022-24627.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2021-33221](CVE-2021-33221.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2021-33044](CVE-2021-33044.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2021-24370](CVE-2021-24370.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2021-1472](CVE-2021-1472.yaml) | Cisco Small Business RV系列 - 命令注入 | 严重 (9.8) | RV16X/RV26X ≤ 1.0.01.02<br>RV34X ≤ 1.0.03.20 | 命令注入 |
| [CVE-2020-17496](CVE-2020-17496.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2020-11530](CVE-2020-11530.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2019-16759](CVE-2019-16759.yaml) | vBulletin 5.0.0-5.5.4 - 远程命令执行 | 严重 (9.8) | vBulletin 5.0.0 - 5.5.4 | RCE |
| [CVE-2019-15859](CVE-2019-15859.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2019-9618](CVE-2019-9618.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2018-16283](CVE-2018-16283.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2018-14916](CVE-2018-14916.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2017-8229](CVE-2017-8229.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2016-1555](CVE-2016-1555.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2016-10033](CVE-2016-10033.yaml) | WordPress PHPMailer < 5.2.18 - 远程代码执行 | 严重 (9.8) | PHPMailer < 5.2.18 | RCE |
| [CVE-2014-2323](CVE-2014-2323.yaml) | 待更新 | 待定 | 待更新 | 待定 |
| [CVE-2014-1203](CVE-2014-1203.yaml) | 待更新 | 待定 | 待更新 | 待定 |

> 注：上表中部分漏洞详情待更新，请参考各个YAML文件获取完整信息。

## 最佳实践

### 测试前准备

1. 获取目标系统的书面授权
2. 在测试环境中验证POC
3. 备份重要数据
4. 准备回滚计划

### 测试执行

1. 从低风险测试开始
2. 记录所有测试步骤和结果
3. 避免对生产环境造成影响
4. 遵守法律法规和道德准则

### 测试后

1. 清理测试数据
2. 生成详细的测试报告
3. 提供修复建议
4. 验证修复效果

## 参考资源

### 工具

- [Nuclei](https://github.com/projectdiscovery/nuclei) - 快速、可定制的漏洞扫描器
- [Nmap](https://nmap.org/) - 网络发现和安全审计工具
- [Burp Suite](https://portswigger.net/burp) - Web应用安全测试平台
- [OWASP ZAP](https://www.zaproxy.org/) - Web应用安全扫描器

### 学习资源

- [OWASP测试指南](https://owasp.org/www-project-web-security-testing-guide/)
- [MITRE ATT&CK框架](https://attack.mitre.org/)
- [CVE详情](https://cve.mitre.org/)
- [NVD数据库](https://nvd.nist.gov/)

## 八、典型漏洞 YAML 文件分析

本目录收录了多种漏洞类型的测试模板，以下对部分典型 YAML 文件进行详细解读，以展示不同漏洞的利用和检测原理。

### 1. CVE-2023-49070.yaml (Apache OFBiz 反序列化 RCE)
- **漏洞类型**：反序列化远程代码执行
- **漏洞原理**：
  由于 Apache OFBiz 的某个 XML-RPC 端点依然存在且未得到良好维护，攻击者可以发送特制的 XML 请求。该请求包含一个可序列化的 Java 对象，当服务器端处理此 XML 时，会触发不安全的反序列化，从而执行攻击者预设的恶意代码。
- **探测原理**：
  该 YAML 模板向 `/webtools/control/xmlrpc` 发送一个包含 `generate_java_gadget` 函数生成的 Java Payload 的 POST 请求。该 Payload 会在反序列化时向攻击者控制的 `interactsh` 服务器发起 DNS 请求。如果 `interactsh` 收到了相应的请求，即可确认漏洞存在。
- **修复建议**：升级 Apache OFBiz 至 18.12.10 或更高版本，并移除或加固不再使用的 XML-RPC 端点。

### 2. CVE-2023-50917.yaml (MajorDoMo 命令注入 RCE)
- **漏洞类型**：操作系统命令注入
- **漏洞原理**：
  MajorDoMo 的 `thumb.php` 脚本在处理用户提供的 `url` 和 `transport` 参数时，未能正确过滤 shell 元字符（如 `|`, `;`）。攻击者可以通过在参数中注入恶意命令，欺骗服务器在处理图片缩略图或媒体流时执行任意系统命令。
- **探测原理**：
  该模板向 `thumb.php` 发送一个 GET 请求，在 `transport` 参数中通过 `||` 注入了 `id` 命令。服务器执行时，`id` 命令的输出（如 `uid=... gid=...`）会包含在返回的页面内容中。通过匹配响应中的 `uid=` 等关键字，即可确认漏洞。
- **修复建议**：升级 MajorDoMo 至 0662e5e 之后的版本，或对 `thumb.php` 中接收的参数进行严格的白名单过滤和转义。

---

#### 总结
该安全测试数据集覆盖了多种高危漏洞，展示了从反序列化到命令注入等多种攻击向量。使用这些模板进行安全测试时，应注意：
- **理解原理**：了解每个漏洞背后的根本原因，而不仅仅是运行工具。
- **安全合规**：始终在获得授权的情况下进行测试。
- **组合利用**：在实际渗透测试中，单个漏洞可能不足以构成严重威胁，但多个漏洞的组合拳往往能取得突破。

